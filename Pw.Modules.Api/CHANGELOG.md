# CHANGELOG — Pw.Modules.Api (ASP.NET Core Minimal API)

Все значимые изменения в этом проекте документируются в этом файле.

## [2025-11-26]
### Добавлено
- Аутентификация:
  - `POST /api/auth/password/reset` — сброс пароля текущего пользователя (требуется заголовок `X-Auth-Token`).
    Если к аккаунту привязан Telegram, новый пароль отправляется туда и не возвращается в ответе; иначе пароль возвращается в теле ответа.

## [2025-10-27]
### Добавлено
- Аутентификация/профиль:
  - `POST /api/auth/username` — изменить имя пользователя (требуется заголовок `X-Auth-Token`).
  - `POST /api/auth/password` — смена пароля (проверка текущего пароля, хеширование нового).

### Изменено
- Уточнена модель DTO и ответы `/api/auth/me` (UserDto) для консистентности с клиентом.

### Примечания
- Эндпоинты интегрированы в группу `/api/auth` и используют уже существующие утилиты AuthUtils.

## [2025-10-23]
### Добавлено
- Эндпоинт статистики: `GET /api/app/stats` — активные пользователи, количество модулей, суммарные запуски модулей.
- Именованная CORS‑политика `PwHub`, разрешающая домены `pw-hub.ru` и `www.pw-hub.ru` (https); применено к группе `/api/app`.

### Изменено
- Включены HealthChecks, HTTP‑логирование, OpenTelemetry (метрики/трейсинг) с возможностью экспорта через OTLP.
- Приложение автоматически применяет EF Core миграции при старте.

### Инфраструктура
- Dockerfile в корне репозитория собирает и публикует `Pw.Modules.Api` (многоступенчатая сборка).

---

## История (ранние версии)
- Базовые сущности: Module, User, Session, UserModule. БД — PostgreSQL (Npgsql).
- Swagger/OpenAPI доступен на корневом пути сервиса.
