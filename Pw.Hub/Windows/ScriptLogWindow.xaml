<Window x:Class="Pw.Hub.Windows.ScriptLogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Выполнение модуля" Height="750" Width="1300" WindowStartupLocation="CenterOwner"
        Icon="/Assets/icon.png"
        MaxHeight="{Binding Source={x:Static SystemParameters.WorkArea}, Path=Height}"
        MaxWidth="{Binding Source={x:Static SystemParameters.WorkArea}, Path=Width}"
        Style="{StaticResource ModernWindowChrome}">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0"
                Style="{StaticResource Panel}"
                Margin="0,0,0,16">
            <TextBlock
                      Text="{Binding Title}"
                      Style="{StaticResource HeaderMedium}"
                      Margin="0"/>
        </Border>

        <!-- Log Output -->
        <Border Grid.Row="1"
               Style="{StaticResource Card}"
               Padding="0"
               Margin="0,0,0,16">
            <DockPanel>
                <Border DockPanel.Dock="Top"
                       Background="{StaticResource AccentBlueBrush}"
                       BorderBrush="{StaticResource BorderBrush}"
                       BorderThickness="0,0,0,1"
                       Padding="12,8">
                    <TextBlock Text="📟 Консоль вывода"
                              Style="{StaticResource ModernTextBlock}"
                              FontWeight="SemiBold"
                              Foreground="{StaticResource AccentHighlightBrush}"/>
                </Border>
                <ScrollViewer x:Name="Scroll"
                             VerticalScrollBarVisibility="Auto"
                             Padding="12">
                    <TextBox x:Name="LogTextBox"
                            IsReadOnly="True"
                            AcceptsReturn="True"
                            TextWrapping="Wrap"
                            BorderThickness="0"
                            Background="Transparent"
                            Foreground="{StaticResource TextPrimaryBrush}"
                            FontFamily="{StaticResource MonospaceFont}"
                            FontSize="12"
                            Text="{Binding LogText}"
                            MinHeight="200"/>
                </ScrollViewer>
            </DockPanel>
        </Border>

        <!-- Progress -->
        <Border Grid.Row="2"
               Style="{StaticResource Card}"
               Margin="0,0,0,12">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0"
                          Style="{StaticResource ModernTextBlock}"
                          Text="{Binding StatusText}"
                          Foreground="{StaticResource TextSecondaryBrush}"
                          Margin="0,0,0,8"/>
                <TextBlock Grid.Row="0" Grid.Column="1"
                          Style="{StaticResource ModernTextBlock}"
                          Text="{Binding PercentText}"
                          FontWeight="SemiBold"
                          Margin="16,0,0,8"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                           Style="{StaticResource ModernTextBlock}"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           Text="{Binding ElapsedText}"
                           Margin="0,0,0,8"/>

                <ProgressBar
                            Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                            Height="24"
                            Minimum="0"
                            Maximum="100"
                            Value="{Binding ProgressValue}"
                            Background="{StaticResource BackgroundTertiaryBrush}"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            Foreground="{StaticResource AccentHighlightBrush}"/>
            </Grid>
        </Border>

        <!-- Actions -->
        <StackPanel Grid.Row="3"
                   Orientation="Horizontal"
                   HorizontalAlignment="Right">
            <Button
                   Style="{StaticResource ModernButton}"
                   Content="⏹ Остановить"
                   MinWidth="130"
                   Padding="16,10"
                   Margin="0,0,8,0"
                   Command="{Binding StopCommand}"/>
            <Button
                   Style="{StaticResource PrimaryButton}"
                   Content="✔ Закрыть"
                   MinWidth="120"
                   Padding="16,10"
                   IsDefault="True"
                   Command="{Binding CloseCommand}"
                   IsEnabled="{Binding CanClose}"/>
        </StackPanel>
    </Grid>
</Window>